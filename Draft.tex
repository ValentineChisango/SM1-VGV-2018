\documentclass[12pt,a4paper]{article}
\usepackage{natbib}
\usepackage{url}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{array}
%\usepackage{appendix}
\usepackage[british]{babel}
\bibpunct[:]{(}{)}{;}{a}{,}{,}

%\newcommand{\dd}[1]{\mathrm{d}#1}
\renewcommand{\baselinestretch}{1.5}

\newcommand{\bi}{\begin{itemize}}
	\newcommand{\ei}{\end{itemize}}
\newcommand{\be}{\begin{enumerate}}
	\newcommand{\ee}{\end{enumerate}}

\begin{document}
	
	\begin{titlepage}
		
		\begin{center}
			\textbf{{\Large Draft Paper}}\\
			\vspace{1cm}
			{\Large Pricing a zero coupon bond by Monte Carlo and Finite Difference Methods when the term structure of interest rates is a mean reverting Ornstein-Uhlenbeck process}\\
			\vspace{1cm}
			\today\\
			Valentine Chisango (CHSVAL002)\\
			{\tt vmchisango@gmail.com}\\ 
			
			George Parekkadavil (PRKMAT004)\\
			{\tt gparekkadavil@gmail.com}\\
			
			Vegan Pather (PTHVEG001)\\
			\tt {veganpather@gmail.com}
			
		\end{center}
	
	\begin{abstract}
		Something interesting in this section
	\end{abstract}	

	\end{titlepage}
	\pagenumbering{arabic}
	\newpage
	
	\section{Introduction}
	\label{sec: Intro}
	
	\newpage
	\section{Background}
	\label{sec: Backgrd}
	
	\newpage
	\section{Methodology}
	\label{sec: Method}
	
	\subsection{Monte-Carlo}

According to Cairns, the methodology involves:

\begin{itemize}
	\item Discretize the SDE using a scheme over a time period [0,T]
	\item Simulate random i.i.d standard normal variables.
	\item Simulate a path of interest rates using the discretized SDE and the i.i.d standard normal variables.
	\item Evaluate the integral $e^{-\int_{t}^{T} r(u)du}$ using one simulated path.
	\item Repeat the evaluation for more paths and take the sample mean as the final estimate of the bond price.
	
	The above steps are mentioned in Cairns(2004:185)
\end{itemize}

A short rate model can be discretized by use of either the Euler or Milstein method. According to Van Appel, the disretization for the Vasicek model is the same under the Euler or Milstein method. The reason for this being the diffusion term does not depend on $r_t$. 

Under this:

$$ \Delta r_t= (alpha-beta r_t)\Delta t+ \sigma \sqrt{\Delta t} z_t+1$$ where $Z_i$

$$r_t+1=r_t+\Delta r_t$$ given $r_0$ to be the initial short rate.


\subsection{Variance reduction techniques}

We make use of three techniques to decrease variance amongst the estimates.The antithetic and moment matching make use of a similar method to the crude monte carlo. The difference occurs in the simulation of the normal RV's. Dependent $Z_i's$  are used to decrease the variance and increase stability amongst the estimate.The control variates makes use of an positively correlated short rate model who's closed form is known.    


\subsubsection{Antithetic variates}

Under this technique, 

\begin{itemize}
	\item First simulate n i.i.d $Z_i's$ and follow the crude monte carlo technique as above.
	\item Repeat the same procedure using  $-Z_i's$
	\item The average of estimates is taken to be the final estimate 
\end{itemize}

Note that $Z_{i}$ and $-Z_{i}$ are negatively correlated and dependent and as such COV( $Z_{i}$,$-Z_{i}$) <0. Therefore if $X$ is the price estimated using $Z_i's$ and $Y$ is estimates using $-Z_i's$, then :

$$Z =\frac{X+Y}{2}$$

and 

$$VAR(Z)=(\frac{1}{2})^{2}(VAR(X)+VAR(Y)+2COV(X,Y))$$

Since the covariance is negative, the larger its value, the lower the variance of the estimate.

\subsubsection{Moment matching}
The moment matching method, specifically first moment matching, where the sample normal $Z_{i}s$ are transformed to $\hat{Z}_{i}=Z_{i}-\bar{Z}$ where $\bar{Z}=\sum_{i=1}^{n}\frac{Z_{i}}{n}$.

The resulting $\hat{Z}_{i}s$ are not independent and are then used to simulate the short rate values and find the estimates.   

 

\subsubsection{Control variates}
Andersen (1995) made use of the Vasicek model as a control variate process when deriving the bond price using the Cox-Ingersoll-Ross(CIR) model. In this paper we use the opposite approach and use the CIR model as the control variate process.

The methodology around this involves

\begin{itemize}
	
	\item Define the price under the close form of the CIR model to be $P_{C}$
	\item Conduct Monte Carlo simulations for the CIR model and define the price under this to be $\hat{P}_{C}$
	\item Conduct Monte Carlo simulations for the Vasicek model and define the price under this to be $\hat{P}_{V}$
	\item Therefore the estimate $P_{V}$:
		  \\$E[P_{V}]=E[P_{C}]-E[\hat{P}_{C}-\hat{P}_{V}]$
		         \\ $= E[P_{V}]$
	\item The variance under such a method will then be 
	\\$VAR[P_{V}]=VAR[\hat{P}_{V}]+VAR[\hat{P}_{C}]-2COV[\hat{P}_{V},\hat{P}_{C}]$
	 
\end{itemize}

The same case here as a larger covariance will decrease the overall variance. 


    





\subsection{Finite difference method}

The finite difference methods works on a space which is partitioned into a grid by two independent variables. The y variable is the initial rate whilst the x variable is time. A boundary condition exists at time T where the price, f(T,.), is set to be 1.The PDE is first discretized .Partial differentials are then calculated at each point on the grid. The bond price is then calculated iteratively at all the grid points by solving for the PDE. The methodology makes use of matrices to solve for the bond prices.  


\subsubsection{Explicit method}

After discretizing the PDE and grouping the similar terms we arrive at the following equation.  

$$f_{i-1,j}=a_{j}f_{i,j-1}+b_{j}f_{i,j}+c_{j}f{i,j+1}$$ 

where i= 0,....,T \\
      j= $r_0, ....r_n$
      
Using the boundary values we substitute into $f_{i,j-1}, f_{i,j}, f{i,j+1}$ and work backwards to calculate the value at point $f_{i-1,j}$ and repeat the process until time t to get the prices for varying interest rates. 

Note that:       
                                                                                                                                

$$a_{j}=(r_t+1/\Delta t)^{-1}\frac{\sigma^{2}}{2(\Delta r_j)^{2}}+\frac{\alpha-\beta r_j}{2\Delta r_j}$$
$$b_{j}=(r_t+1/\Delta t)^{-1}\frac{1}{\Delta t}-\frac{\sigma^2}{\Delta r_j}^{2}$$
$$c_{j}=(r_t+1/\Delta t)^{-1}\frac{\sigma^{2}}{2(\Delta r_j)^{2}}+\frac{\alpha-\beta r_j}{2\Delta r_j}$$

Under the matrix formulation we have the equation to be:

$$F_{i-1}=AF_{i}+K_{i}$$

where

$$F_{i}= \begin{bmatrix}
			f_{i,1} \\
			f_{i,2} \\
			\vdots \\
			f_{i,r_{n-1}}
		\end{bmatrix}
$$
     
$$K_{i}= \begin{bmatrix}
			a_{1}f_{i,0} \\
			0 \\
			\vdots \\
			0 \\
			c_{j-1}f_{i, r_{n-1}}
		\end{bmatrix}  $$
		
		
$$ A= \left( \begin{array}{cccccc}
b_{1} & c_{1} & 0 & \cdots  & 0 & 0\\
a_{2} & b_{2} & c_{2} &\cdots & 0 & 0 \\
 & a_{3} & b_{3} & \cdots & 0 & 0  \\
 & \vdots &\vdots & \ddots & \vdots & \vdots \\ 
 & 0 & 0 & \cdots & a_{n-1} & b_{n-1} \end{array} \right) $$
 
 
 
\subsubsection{ Implicit method}

Under this case , once the dicretizationa and grouping of terms occur , we obtain

$$f_{i+1,j}= a_{j}f_{i,j-1}+b_{j}f_{i,j}+c_{j}f{i,j+1} $$

In this case the value at $f_{i+1,j}$ is used to work out the other 3 values. This can be done simultaneously as when all the equations are written down, there are equal number of equations as to unknowns.


Under this case

$$a_{j}= (\frac{\alpha-\beta r_{j+1}}{2\Delta r} - \frac{\sigma^2}{2\Delta r^2})\Delta t$$ 
$$b_{j}= (r_{j+1}+\frac{1}{\Delta t} + \frac{\sigma^2}{\Delta r ^2})\Delta t$$
$$c_{j}= (\frac{\alpha-\beta r_{j+1}}{2\Delta r} + \frac{\sigma^2}{2\Delta r^2})(-\Delta t) $$

The matrix formulation is:

$$ BF_{i}= F_{i+1}+K{i}$$


$$F_{i}= \begin{bmatrix}
f_{i,1} \\
f_{i,2} \\
\vdots \\
f_{i,r_{n-1}}
\end{bmatrix}
$$


$$K_{i}= \begin{bmatrix}
-a_{1}f_{i,0} \\
0 \\
\vdots \\
0 \\
-c_{j-1}f_{i, r_{n-1}}
\end{bmatrix}  $$

where $B$ is the tridiagonal matrix with the entries similar to the explicit method.

\subsubsection{Crank Nicholson}

$$a_{j}=(\frac{\alpha-\beta r_{j+1}}{4\Delta r} - \frac{\sigma^2}{4\Delta r^2}) $$

$$b_{j}= \frac{\sigma^2}{2 (\Delta r)^2}+\frac{r_{j}}{2}$$

$$c_{j}=(-\frac{\alpha-\beta r_{j+1}}{4\Delta r} - \frac{\sigma^2}{4\Delta r^2}) $$

The matrix formulation under this method is :

$$CF_{i-1}=DF_{i-1}+K_{i-1}+K_{i}$$

where

$$ A= \left( \begin{array}{cccccc}
1-b_{1} & -c_{1} & 0 & \cdots  & 0 & 0\\
-a_{2} & 1-b_{2} & -c_{2} &\cdots & 0 & 0 \\
& -a_{3} & 1-b_{3} & \cdots & 0 & 0  \\
& \vdots &\vdots & \ddots & \vdots & \vdots \\ 
& 0 & 0 & \cdots & -a_{n-1} & 1-b_{n-1} \end{array} \right) $$

$$ D= \left( \begin{array}{cccccc}
1+b_{1} & c_{1} & 0 & \cdots  & 0 & 0\\
a_{2} & 1+b_{2} & c_{2} &\cdots & 0 & 0 \\
& a_{3} & 1+b_{3} & \cdots & 0 & 0  \\
& \vdots &\vdots & \ddots & \vdots & \vdots \\ 
& 0 & 0 & \cdots & -a_{n-1} & 1+b_{n-1} \end{array} \right) $$
	
	\newpage
	\section{Results}
	\label{sec: Results}
	
	\subsection{Comparision of Numerical Methods}
	\label{subsec: Compar}
	The methodology was implemented in R under an arbitrary set of parameters, where $\alpha = 0.08$, $\beta = 0.8$ and $\sigma=0.005$. This implied a mean rate of 0.10 under the short rate model and an initial rate of 0.08 was selected. These are annually effective and the time to maturity is 5 years. The Monte Carlo methods were all implemented under 1000 trials and with a partition of 200 subintervals over the time range. The partition of time for the finite difference methods was composed of 1250 equally-spaced subintervals, which is consistent with 250 trading days per year. The discrete set of short rates ranged from -0.4 to 0.6 with a step of 0.005. Table 1 provides the corresponding bond prices for each method under these parameters along with the differences between these prices and the known solution. The approximate time to run each method is provided in seconds.
	
	
	
\begin{table}[ht]
	\centering
	\caption{Comparision of Bond Prices for Numerical Methods}
	
	
	\begin{tabular}{|>{\centering\arraybackslash}m{4.5cm}|>{\centering\arraybackslash}m{2cm}|>{\centering\arraybackslash}m{2cm}|>{\centering\arraybackslash}m{2cm}|>{\centering\arraybackslash}m{2.5cm}|}
		\hline
		Numerical Method & Price & Known Price & Error & Computation Time \\ 
		\hline
		Crude Monte Carlo & 0.62136 & 0.62164 & 0.00028 & 1.41000 \\ 
		Antithetic Variates & 0.62826 & 0.62164 & -0.00662 & 1.89000 \\ 
		Moment Matching & 0.62823 & 0.62164 & -0.00659 & 0.89000 \\ 
		Control Variates & 0.62244 & 0.62164 & -0.00081 & 2.75000 \\ 
		Explicit Method & 0.62194 & 0.62164 & -0.00031 & 0.11000 \\ 
		Implicit Method & 0.62193 & 0.62164 & -0.00030 & 0.14000 \\ 
		Crank-Nicolson Method & 0.62188 & 0.62164 & -0.00024 & 0.23000 \\ 
		\hline
	\end{tabular}
\end{table}
newpage
\subsection{Sensitivity tests}
\label{subsec: Senses}
In order to confirm that the behaviour of the numerical methods is as expected under different parameters, several different parameter values are tested. The initial set of parameters are those used in section \ref{sec : Compar}. From here the input parameters are varied one at time, with $\alpha$ and $\beta$ varied together in the final two scenarios tested. For each parameter varied, the bond price produced by each numerical method (labelled from 2 to 8 in the order Closed Form,Crude Monte Carlo, Antithetic Variates, Moment Matching, Control Variates, Explicit, Implicit, Crank Nicholson) under the chosen scenarios is plotted along with the bond price produced by the closed form solution (labelled 1).\\\\
In varying the interest rate from the initial $8\%$, all methods behave as expected. When the interest rate is reduced to $5\%$, the bond price decreases. When the interest rate is raised to $10\%$, the bond price increases.	Varying the time to maturity ($T$) from the initial $5$ years also results in the expected behaviour: bond prices increase when $T=1$ and decrease when $T=10$. However, the bond price produced by the explicit method decreases significantly and is in fact $-4.873359\times10^{32}$. This is caused by [missing].\\\\
All the methods don't result in significant changes to the bond price when the standard deviation is increases from the initial $0.5\%$ to $1\%$. When the standard deviation decreases to $0.1\%$, the Monte-Carlo methods don't see significant changes in bond prices while the finite differences produce bond prices in excess of 2. This highlights the flaw in finite difference methods in that they produce very large prices, that don't make financial sense since they exceed the pay-off of the bond, when the standard deviation is sufficiently small and almost vanishes from the PDE along with its coefficients.\\\\
When alpha is decreased from the initial $0.08$, the bond prices for all methods increase. When alpha is increased, the bond prices for all methods decrease, with the price produced by the explicit method again decreasing rapidly to $-1.257679$. When the value of beta is decreased from the initial $0.8$, the bond price produced by all methods decreases. When beta is increases, the bond price produced by all methods increases, which the exception of the explicit. For the explicit method, the price is once again negative and equal to $-2.492100\times10^{45}$. If alpha and beta are varied simultaneously such the mean remains constant and only the mean reversion rate changes then the bond prices don't vary significantly, with the prices being higher for the higher mean reversion rates (i.e. the higher beta value). Again an exception is found with the explicit method, where the price for the increased beta is $-5.065734\times10^{34}$.
	\newpage
	\section{Discussion}
	\label{sec: Discuss}
	
	\newpage
	\section{Conclusions}
	\label{sec : Concl}
	

	
	\newpage
	\bibliographystyle{natbib}
	\bibliography{myref}	
	
	\newpage
	\appendix
	\section{Appendix A}
	\label{sec: Appendix A}
	\subsection{Details of the Model}
	\label{subsec: Details}
	The formulation consists of a zero-coupon bond issued at some time $t \geq 0$ where a corresponding payment of 1 unit will be made at the maturity time $T \geq t$. The risk of default is negligible \citep{shreve2004stochastic}. The bond is priced by using the short rate process $\{r_{s}:t \leq s \leq T\}$.
	
	For the time interval $[t,T]$ the filtered probability space $(\Omega, \mathcal{F}^W,\mathbb{F}^W,\mathbb{P})$ is used and $r_t$ is known \citep{mamon2004three}. A risk neutral measure $\mathbb{Q}$ is defined and it is equivalent to $\mathbb{P}$ \citep{shreve2004stochastic}. The short rate process, which is an Ornstein-Uhlenbeck process, then satisfies the following stochastic differential equation: 
	\begin{equation}
	dr_{t} = (\alpha-\beta r_{t})dt + \sigma dW_{t} \quad \alpha, \beta \in \mathbb{R}, \sigma>0, \beta \neq 0
	\end{equation}
	
	
	The bond price $B(t,T,r_t)$ with boundary condition of $B(T,T,r_t) = 1$, is then determined through computing the following risk-neutral expectation:
	\begin{equation}
	B(t,T,r_t) = \mathbb{E}^{\mathbb{Q}}\left[exp\left(-\int_{t}^{T}r_{s} ds\right)\middle\vert\mathcal{F}_{t}^{W_{t}}\right]
	\end{equation}
	
	
	\subsection{The Partial Differential Equation}
	\label{subsec: PDE}
	The following expression is the PDE, derived from (2), which is required to obtain the price of a zero-coupon bond when the term structure of interest rates follows the Ornstein-Uhlenbeck process. .
	$$\boxed{-r_t B(t,T,r_t) + \frac{\partial}{\partial t} B(t,T,r_t) + \frac{\partial}{\partial r_t}B(t,T,r_t)(\alpha - \beta r_t) +\frac{1}{2} \sigma^2 \frac{\partial^2}{\partial r_t^2} B(t,T,r_t) = 0 }$$
	
	\noindent This PDE is accompanied by the boundary condition $B(T,T,r_t) = 1$
	\subsection{The Closed Form Solution}
	\label{subsec: Closed Form}
	
	A closed form solution to the above PDE exists and as per \cite{mamon2004three}, it is given by the following expression:
	\begin{gather*}
	\boxed{B(t,T,r_t) =exp(-A(t,T)r_t+D(t,T))}
	\end{gather*}
	where
	\begin{align*}
	A(t,T)&=\frac{\beta(1-e^{-\beta(T-t)})}{\alpha}\\
	D(t,T)&=\frac{1}{\beta}\left[\left(\alpha-\frac{\sigma^2}{2\beta}\right)[A(t,T)-(T-t)]-\frac{\sigma^2A(t,T)^2}{4}\right]
	\end{align*}
	
	\newpage
	\section{Appendix B}
	\label{sec: Appendix B}
	\subsection{Monte Carlo Simulation}
	\label{subsec: MC}
	The methodology involved in Monte-Carlo simulations are:
	
	\begin{itemize}
		\item Discretize the SDE using a scheme over a time period [0,T]
		\item Simulate random i.i.d standard normal variables.
		\item Simulate a path of interest rates using the discretized SDE and the i.i.d standard normal variables.
		\item Evaluate the integral $e^{-\int_{t}^{T} r(u)du}$ using one simulated path.
		\item Repeat the evaluation for more paths and take the sample mean as the final estimate of the bond price.
		
		The above steps are mentioned in Cairns(2004:185)
	\end{itemize}
	
	
	
	\subsubsection{Schurman's Method Under the Vasicek Model}
	\label{subsubsec: Schurman}
	
	Schurman(2009) determined the following formula as the bond price for one interest rate path with fixed parameters.  
	
	$$f(h,n)=F\times exp[-\{\frac{1}{2}r_{0}+\sum_{j=1}^{k-1}r_{j} +\frac{1}{2}r_{k}\}h]$$
	
	where F is the face value of the bond, h is the time interval, n being the number of the path simulated and $r_{j}$ are the short rate values simulated. Monte Carlo simulations are then run on each path level to determine the price of along that simulated interest rate path. Once N simulations have been completed, the final price is then determined by taking the average of the prices across N simulations.   
	
	\subsection{Finite Difference Methods}
	\label{subsec: FD}
	A space-time grid (or lattice) is defined by the independent variables of $t$ and $r_t$ \citep{crank}. The interval $[t,T]$ is partitioned into equal sub-intervals with indices of  $n=0,1,...,N$. The range of $r_t$ (which is treated as the space variable) is partitioned with indices of $i = 1,...,I$. The lenght of each $r$ sub-interval is taken as $\Delta r_t$ and the lenght of each $t$ sub-interval is taken as $\Delta t$. The function in the PDE is given by $f(t,r_t)= B(t,T,r_t)$ with boundary condition $f(T,r_t) = 1$ and $r_t$ being known. The algorithm starts at $f(T,r_t)$ works backwards until the solution is reached and this runs over the $(N+1)\times(I+1)$ grid points. At a single gridpoint $(n,i)$, the following approximations are made:
	\subsubsection{Explicit Method}
	\label{subsubsec: Explicit}
	$$\frac{\partial f}{\partial t} = \frac{f(n+1,i) - f(n,i)}{\Delta t}$$
	$$\frac{\partial f}{\partial r_i} = \frac{f(n+1,i+1) -f(n+1,i-1)}{2 \Delta r_i}$$
	$$\frac{\partial^2 f}{\partial r_i^2} = \frac{f(n+1,i+1) - 2f(n+1,i) +f(n+1,i-1)}{\Delta r_i^2}$$
	
	This is used in the PDE as follows
	$$-r_i f(n,i)  + \frac{\partial f}{\partial t} + \frac{\partial f}{\partial r_i}(\alpha - \beta r_i) +\frac{1}{2} \sigma^2 \frac{\partial^2 f}{\partial r_i^2}  = 0 $$
	
	\subsubsection{Implicit Method}
	\label{subsubsec: Implicit}
	$$\frac{\partial f}{\partial t} = \frac{f(n+1,i) - f(n,i)}{\Delta t}$$
	$$\frac{\partial f}{\partial r_i} = \frac{f(n,i+1) -f(n,i-1)}{2 \Delta r_i}$$
	$$\frac{\partial^2 f}{\partial r_i^2} = \frac{f(n,i+1) - 2f(n,i) +f(n,i-1)}{\Delta r_i^2}$$
	
	This is used in the PDE as follows
	$$-r_i f(n+1,i)  + \frac{\partial f}{\partial t} + \frac{\partial f}{\partial r_i}(\alpha - \beta r_i) +\frac{1}{2} \sigma^2 \frac{\partial^2 f}{\partial r_i^2}  = 0 $$
	\subsubsection{Crank-Nicolson Method}
	\label{subsubsec: Crank Method}
	
	$$\frac{\partial f}{\partial t} = \frac{f(n+1,i) - f(n,i)}{\Delta t}$$
	$$\frac{\partial f}{\partial r_i} = \frac{f(n,i+1) - f(n,i-1) +f(n+1,i+1) -f(n+1,i-1)}{2 \Delta r_i}$$
	
	\begin{gather*}
	\frac{\partial^2 f}{\partial r_i^2} = \frac{f(n,i+1) - 2f(n,i) + f(n,i-1)}{2\Delta r_i^2}
	+ \frac{f(n+1,i+1) - 2f(n+1,i) +f(n+1,i-1)}{2\Delta r_i^2}
	\end{gather*}
	
	This is used in the PDE as follows
	$$-\frac{1}{2}r_i f(n,i)-\frac{1}{2} r_i f(n+1,i) + \frac{\partial f}{\partial t} + \frac{\partial f}{\partial r_i}(\alpha - \beta r_i) +\frac{1}{2} \sigma^2 \frac{\partial^2 f}{\partial r_i^2}  = 0 $$
	
	The PDE can then be simplified further which results in solving a tridiagonal system of equations \citep{Cairns}.
		
		
\end{document}
